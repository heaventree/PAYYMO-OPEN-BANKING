<!-- Bank Connection Wizard Modal -->
<div class="modal fade" id="bankConnectionModal" tabindex="-1" aria-labelledby="bankConnectionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="bankConnectionModalLabel">Connect to Your Bank</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Wizard Progress -->
                <div class="wizard-progress mb-4">
                    <div class="progress" style="height: 4px;">
                        <div class="progress-bar bg-primary" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <div class="d-flex justify-content-between">
                        <div class="step">
                            <div class="step-icon bg-primary text-white d-flex align-items-center justify-content-center">
                                <span>1</span>
                            </div>
                            <div class="step-label">Select Bank</div>
                        </div>
                        <div class="step">
                            <div class="step-icon bg-light border d-flex align-items-center justify-content-center">
                                <span>2</span>
                            </div>
                            <div class="step-label">Authorize</div>
                        </div>
                        <div class="step">
                            <div class="step-icon bg-light border d-flex align-items-center justify-content-center">
                                <span>3</span>
                            </div>
                            <div class="step-label">Complete</div>
                        </div>
                    </div>
                </div>
                
                <!-- Step 1: Select Bank -->
                <div class="step-content step-1">
                    <div class="mb-4">
                        <h5 class="mb-3">Select Your Bank</h5>
                        <p class="text-muted">Choose your financial institution from the list below.</p>
                    </div>
                    
                    <div class="form-group mb-3">
                        <div class="input-group">
                            <span class="input-group-text bg-white">
                                <i data-lucide="search" style="width: 16px; height: 16px;"></i>
                            </span>
                            <input type="text" class="form-control" placeholder="Search for your bank...">
                        </div>
                    </div>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="briefcase" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">Barclays</h6>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="landmark" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">HSBC</h6>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="landmark" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">Lloyds</h6>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="globe" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">Monzo</h6>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="landmark" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">Santander</h6>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-4">
                            <div class="bank-option p-3 border rounded text-center cursor-pointer">
                                <i data-lucide="landmark" class="me-1" style="width: 18px; height: 18px;"></i>
                                <h6 class="mt-2 mb-0">NatWest</h6>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button class="btn btn-outline-secondary btn-sm">Show All Banks</button>
                    </div>
                </div>
                
                <!-- Step 2: Authorize Bank -->
                <div class="step-content step-2 d-none">
                    <div class="text-center mb-4">
                        <h5 class="mb-3">Connect to Bank</h5>
                        <p class="text-muted">You'll be redirected to your bank's website to securely authorize access.</p>
                    </div>
                    
                    <div class="auth-info border rounded p-4 mb-4">
                        <div class="d-flex align-items-center mb-3">
                            <i data-lucide="shield-check" class="text-success me-2" style="width: 24px; height: 24px;"></i>
                            <h6 class="mb-0">Secure Connection</h6>
                        </div>
                        <p class="text-muted mb-0">Your credentials are never stored. We use Open Banking APIs to securely connect to your bank account.</p>
                    </div>
                    
                    <div class="auth-permissions">
                        <h6 class="mb-3">You're granting permission to:</h6>
                        <ul class="list-group mb-4">
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <i data-lucide="check-circle" class="text-success me-2" style="width: 16px; height: 16px;"></i>
                                <span>Access account information</span>
                            </li>
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <i data-lucide="check-circle" class="text-success me-2" style="width: 16px; height: 16px;"></i>
                                <span>View transaction history</span>
                            </li>
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <i data-lucide="check-circle" class="text-success me-2" style="width: 16px; height: 16px;"></i>
                                <span>Match transactions to invoices</span>
                            </li>
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center text-muted">
                                <i data-lucide="x-circle" class="text-muted me-2" style="width: 16px; height: 16px;"></i>
                                <span>No permission to move money</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <!-- Step 3: Complete -->
                <div class="step-content step-3 d-none">
                    <div class="text-center mb-4">
                        <i data-lucide="check-circle" style="width: 48px; height: 48px;" class="mb-3 text-muted"></i>
                        <h5 class="mb-3">Connection Complete</h5>
                        <p class="text-muted">Your bank account has been successfully connected.</p>
                    </div>
                    
                    <div class="connected-account border rounded p-3 mb-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center">
                                <div class="bank-logo me-3 bg-light rounded p-2">
                                    <i data-lucide="landmark" style="width: 24px; height: 24px;"></i>
                                </div>
                                <div>
                                    <h6 class="mb-1">Bank Name</h6>
                                    <p class="mb-0 small text-muted">Account ending in ****1234</p>
                                </div>
                            </div>
                            <span class="badge bg-success">Connected</span>
                        </div>
                    </div>
                    
                    <div class="connection-info mb-4">
                        <h6 class="mb-3">What happens next?</h6>
                        <ul class="list-group">
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <div class="step-number me-3">1</div>
                                <span>We'll start importing your transactions automatically</span>
                            </li>
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <div class="step-number me-3">2</div>
                                <span>Transactions will be matched to invoices</span>
                            </li>
                            <li class="list-group-item border-0 ps-0 d-flex align-items-center">
                                <div class="step-number me-3">3</div>
                                <span>You'll receive notifications for any transactions that need review</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="bankWizardNextBtn" disabled>Continue to Authorization</button>
            </div>
        </div>
    </div>
</div>

<style>
.cursor-pointer {
    cursor: pointer;
}

.wizard-progress {
    position: relative;
    padding-top: 30px;
}

.step {
    text-align: center;
    z-index: 1;
    flex: 1;
}

.step-icon {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    margin: 0 auto 8px;
    font-size: 12px;
}

.step-label {
    font-size: 12px;
    color: var(--bs-gray-600);
}

.bank-option {
    transition: all 0.3s ease;
}

.bank-option:hover {
    border-color: var(--bs-primary) !important;
    background-color: rgba(var(--bs-primary-rgb), 0.05);
}

.auth-info {
    background-color: rgba(var(--bs-success-rgb), 0.05);
}

.bank-logo {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.step-number {
    width: 24px;
    height: 24px;
    background-color: var(--bs-primary);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    flex-shrink: 0;
}
</style>